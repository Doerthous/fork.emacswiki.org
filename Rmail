Rmail is the default mail reader for GNU Emacs.  With it you can read
multiple local and remote inboxes.

::: //Rmail is the primary Emacs mail-reader.  I don't know how many
people currently use it, but I will ignore any suggestion to treat it
as unimportant.// -- [[RichardStallman]]
[http://lists.gnu.org/archive/html/emacs-devel/2004-09/msg00328.html]

See GettingMail, WritingMail, and SendingMail for more setup examples.

== Configuration ==

You should download the `mailutils' package on your computer if you
want the best rmail experience.

Here is a detailed Rmail configuration. A simpler example is in [[GettingMail]].

<pre>
(setq
 ;; The mail URL, specifying a remote mail account
 ;; (Omit this to read from /var/mail/user)
 rmail-primary-inbox-list
  '("pop://me%40example.com:Passw0rD@mail.example.com"))

 send-mail-function 'smtpmail-send-it       ; Send mail via SMTP
 rmail-preserve-inbox 1                     ; Don't delete mail from server
 rmail-delete-after-output 1                ; Delete original mail after copying
 rmail-mime-prefer-html nil                 ; Prefer plaintext when possible
 rmail-file-name   "~/mail/inbox"           ; The path to our inbox file
 rmail-secondary-file-directory "~/mail"    ; The path to our other mbox files
 message-default-headers "Fcc: ~/mail/sent" ; Copy sent mail to the "sent" file
 user-full-name    "Susan"                  ; Our full name
 user-mail-address "me@example.com"         ; Our return address
 message-signature "Plop! -S")              ; A signature
</pre>

You can also decide how rmail handles HTML emails with the `shr'
variables:

<pre>
(setq
 shr-use-fonts nil  ; Don't load fancy fonts
 shr-indentation 2  ; A left-margin of 2 columns
 shr-use-colors nil ; Don't load special colors
 shr-width 70       ; Fix width to 70 columns
 shr-bullet "• ")   ; A bullet character for <li> elements
</pre>

Note that the `shr' variables also apply to the [[EmacsWebWowser]]

== Basic Usage ==

Start rmail with `M-x rmail'. With no configuration, this attempts to
move all your mail from your local spool file to the Rmail primary
file pointed by `rmail-file-name' (defaults to ##~/RMAIL##)

Some helpful keys:

* <code>?</code> - Full list of keybindings
* <code>n</code> - Next message
* <code>p</code> - Previous message
* <code>d</code> - Mark current message for deletin
* <code>u</code> - Unmark current message
* <code>x</code> - Delete all marked messages
* <code>r</code> - Reply
* <code>m</code> - Compose a new email
* <code>o</code> - Output mail to an mbox file
* <code>i</code> - Open an mbox file
* <code>a</code> - Add label to current message
* <code>l</code> - Filter inbox by label
* <code>M-s</code> - Search all mail

Rmail //used// to store mail in a [[Babyl]] file. As of Emacs 23,
rmail uses a standard [http://web.archive.org/web/20160304055659/http://homepage.ntlworld.com./jonathan.deboynepollard/FGA/mail-mbox-formats.html mbox format]:
mboxo. mboxo performs some irreversible conversions such as replacing
<code>From</code> in the body of a mail with <code>>From</code> if it
occurs at the start of a line.  For most people this is unimportant.

== Reading mail ==

Pressing `h' makes a summary window appear.  You can navigate between
messages with the `n' and `p' keys for next and previous respectively.
The space key, `SPC', scrolls down through messages.  When you get to
the end of a message, it goes on to the next message.  The `DEL' key
does the same but in the opposite direction.

You can tell how many messages you want to appear in the summary
buffer with `rmail-summary-window-size'.

=== Mailing lists ===

Use the handy command `M-x undigestify-rmail-message' when viewing a
mailing list digest to split it into separate messages.  The original
message is marked for deletion.

== Writing mail ==

To start writing a new message, you can use `C-x m' or `M-x mail' from
anywhere in Emacs.

If you are in an rmail buffer, just press `m' to create a new mail, `r' to
reply to a message, or `f' to forward a message.

By default, rmail uses [[MailMode]] for composition. You can change
this by setting the `mail-user-agent' variable:

<pre>
;; Use Mail mode to compose messages (default)
(setq mail-user-agent 'sendmail-user-agent)

;; To use Message mode instead:
(setq mail-user-agent 'message-user-agent)
</pre>

== Sorting mail ==

=== Labels (tags) ===
Simply add one or more labels to an email by pressing `a' while viewing the
message.  You can add multiple labels at once by separating them with a comma.

To remove labels press `k'.  As with adding labels, you can use a comma in
between labels to remove more than one.

Press `l' to show a summary window of the emails with the labels you'd like to
see.

=== Output files ===
Rmail doesn't use folders, but you can file messages in different rmail
files.  Press `o' while viewing a message to add it to another rmail file.
Note that if the other file is open, you'll need to save it manually.

For example, I receive mail in my RMAIL file and add messages to separate
files such as FAMILY, MAILING_LISTS, etc.  I usually delete those messages
so that my "inbox" file remains small.

The variable `rmail-output-file-alist' lets you set default files for specified
email addresses.  Then you don't have to type the name of the file each time you
press `o'.  If you set `rmail-automatic-folder-directives', filing happens
automatically after the mail is received from the inbox.

== Dealing with spam ==

You can filter out spam by using RmailSpamFilter.  There is also RmailSpamprobe.

== Dealing with attachments and non-ASCII mails ==

You can display attachments using RmailMime.

Non-ASCII mails often use "encoded-words" as specified in RFC 2047.
Here's how to use rfc2047.el that comes with Emacs:

<pre>
(autoload 'rfc2047-decode-string "rfc2047")
(autoload 'rfc2047-decode-region "rfc2047")
(setq rmail-message-filter
      (lambda ()
        (save-excursion
          (when (search-forward "\n\n" nil t)
            (rfc2047-decode-region
              (point-min) (match-beginning 0)))))
      rmail-summary-line-decoder
      (function rfc2047-decode-string))
</pre>

[MDL: The above only works for summary lines in Emacs 23 because rmail-message-filter is no longer used.  Anyone have a fix for this?]

== Editing message text and headers ==

Pressing `e' in an rmail buffer puts you in editing mode.  If you
accidentally got there, press `C-c C-]' to abort.  Otherwise, make your changes,
then press `C-c C-c' to save them and return to reading mode.

== Converting Babyl files to mbox format ==

If you tried Rmail with an Emacs version prior to 23 and
you decide that Rmail is not for you, you can later read mail from the Babyl
file if you are using [[Gnus]].  For all other mail readers, you'll have
to move the mails back into mbox format.  Use `M-x unrmail' to convert the mail file.
You can also use the command-line tool ##b2m## to do it.  Starting with version 23,
Emacs converts Babyl files back into mbox when it first reads them.

== Rmail Libraries ==

Read mail from remote inboxes using ange-ftp with rmail-extras
http://bmrc.berkeley.edu/~trey/emacs/src/rmail-extras.el (dead link? Local
copy: Lisp:rmail-extras.el).

Thread messages with
[http://ftp.ccs.neu.edu/pub/people/ratinox/emacs-lisp/trmail.el trmail].

RmailConversationSummary has a
conversation view à la Gmail (no threading in the summary, list sender and
beginning of message body instead).

Generate guesses for output and FCC files using rmailgen -- Lisp:rmailgen.el

Save single messages to files using rmail-saver -- Lisp:rmail-saver.el

Always show headers in the same order -- RmailSortHeaders

== Searching Mails ==

You can search through mail with <code>M-s</code>, or with [[MairixSearch]].

== External Links ==

* [https://www.gnu.org/software/emacs/manual/html_node/emacs/Rmail.html The rmail manual]
* [https://cadadr.dreamwidth.org/828.html cadadr's rmail article]
* [https://muto.ca/posts/actually-using-emacs-rmail.html Muto's rmail article]
* [https://alexschroeder.ch/wiki/2020-12-17_Rmail Alex Schroder's rmail post]
* [http://ruzkuku.com/texts/rmail.html Philip K.'s rmail article]

== Open Questions ==

How do I download e-mails with movemail from remote POP3 mailboxes
with SSL? The GNU mailutils movemail version doesn't seem to support
SSL, only TLS encryption.

-- TLS is just a synonym for SSL, to setting rmail-movemail-flags to "--tls" does the job.

-- No way, I tried and movemail says some "I/O error", I don't know why.  On the movemail list people raccomend using `stunnel' to tunnel the connection using SSL.  So really TLS != SSL.  I think I'm back to fetchmail.  And maybe another more modern emacs e-mail client that has built-in support for such basic things as MIME...  Any suggestions?

-- "--tls" only worked for me after installing GNU mailutils, although I could get email with rmail before installing GNU mailutils

How do you use Emacs to sort RMAIL email based on SpamAssassin headers?...

Please list instructions for a Postfix Maildir mailbox. These don't work: http://support.cs.utah.edu/index.php?option=com_content&view=article&id=26&Itemid=52 I tried without the "mdmovemail" line since there's a "movemail" in the /usr filesystem. Regards

Can it support mboxrd files?

----
CategoryMail
