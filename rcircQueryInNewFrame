I never got this to work right and I'm not using it any more, but here is what I had:

I want query windows to pop up a new frame in [[rcirc]].

Here is what I'd normally use:

<pre>
(defun query-p (buf act)
  (and
   (eql 'rcirc-mode
	(with-current-buffer buf
	  major-mode))
   (string-match "^[a-zA-Z]"
		 (with-current-buffer buf
		   (buffer-name)))))

(push
 (cons 'query-pred display-buffer--other-frame-action)
 display-buffer-alist)
</pre>

But, rcirc doesn't respect the normal display-buffer stuff. (A bug?)
It's good that it defaults to opening stuff in the background, butâ€¦

For now, here is a quick workaround for that that seems to work, when
used together with the above:

<pre>
(defun display-and-return (bon)
  (when (query-p bon nil)
   (display-buffer bon))
  bon)

(advice-add 'rcirc-get-buffer-create :filter-return #'display-and-return)
</pre>

