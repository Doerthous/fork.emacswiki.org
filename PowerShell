== What is Powershell? ==

!PowerShell is Microsoft's modern command line shell and scripting language, targeted especially at IT management and automation.  It's effectively a command line environment for the .NET Framework (which is their answer to Java and Java's standard libraries).  Syntactically, !PowerShell strongly resembles [[Perl]]; semantically, it's a bit more like [[Python]]; with a bit of DEC VMS thrown in for flavor.  Introduced in 2006 as a Windows-only thing, !PowerShell is now available for Mac and Linux, too.  It is still under active development in  2021.  !PowerShell source code files typically have extensions of ##.ps1## or ##.psm1##.

[[WikiPedia:PowerShell]]

http://Microsoft.com/powershell 

== Editing Mode ==

As of Emacs 27.1, there is no "official" `powershell-mode', but there have been various third-party implementations:  

* Vivek Sharma
** Original (dead): ##http://VivekSharma.com/techlog/attache/powershell-mode.el.txt##
** Archive: http://web.archive.org/web/20170810092842/http://viveksharma.com/techlog/attache/powershell-mode.el.txt
** Originally released circa 2006
** Latest version 0.5 dated 2008 August 19
** Site offline since circa 2018
* Frédéric Perrin
** http://svn.fperrin.net/powershell-mode/powershell-mode.el
** Originally released circa 2009
** Latest version 792 dated 2012
** speedbar/imenu support, syntax highlighting, may lack !PowerShell 2.0+ support
* Rick Bielawski
** [[Lisp:PowerShell-Mode.el]]
** Based on Frédéric Perrin's work, with significant updates by [[Rick Bielawski]]
** Last updated 2014 January
** Development/release nominally homed on this wiki
* Joe Schafer (jschaf)
** https://github.com/jschaf/powershell.el
** Originally released 2013 June
** Last updated 2020 October
** Available in [[MELPA]] with ##M-x package-install RET powershell RET##

Above links and versions last checked 2021 November.

== Powershell as an Inferior Shell == 

Download Lisp:Powershell.el  (updated 20 May 2010)

* [http://Nabble.com/Run-powershell-as-a-shell-within-Emacs-on-Windows-td17504130.html News Item]
* [http://Blogs.MSDN.com/dotnetinterop/archive/2008/04/10/run-powershell-as-a-shell-within-emacs.aspx Blog post]

http://i40.tinypic.com/16i8bc8.jpg


=== HTTP GET via Powershell ===

Some people report that the url.el exhibits problems when retrieving content from https: endpoints. 
This fn performs a "wget" using Powershell.  Works only on Windows.

    (defun wget-via-powershell (url &optional ext)
      "get the contents of a URL into a file via powershell. The EXT
            is the extension to use on the destination file. It should begin
            with a dot.
            "
      (flet ((rris (a1 a2 s) (replace-regexp-in-string a1 a2 s)))
        (let* ((ext (or ext ".txt"))
               (url-tmpf (make-temp-file "emacs-wget-" nil ext))
               (ps-cmd (concat
                        "(new-object System.Net.WebClient).DownloadFile("
                        (rris (char-to-string 34)
                              (char-to-string 39)
                              (pp-to-string url))
                        ","
                        (rris "/"
                              "\\\\"
                              (rris (char-to-string 34)
                                    (char-to-string 39)
                                    (pp-to-string url-tmpf)))
                        ")"))
               (shell-command
                (format "%s -Command %s"
                        bundlify-powershell-exe
                        (concat "\"& {" ps-cmd "}\""))))

          (shell-command-on-region (point) (point)
                                   shell-command
                                   nil nil nil)
          ;;(message "downloaded to %s" url-tmpf)
          url-tmpf)))

== Discussion ==

Discussion available at: [[Comments on PowerShell]]
